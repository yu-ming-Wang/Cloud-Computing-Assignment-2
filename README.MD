# Assignment 2

**Author:** Yu-Ming (Jonathan) Wang

---

## ğŸ— Repository Structure

```
Cloud-Computing-Assignment-2/
â”‚
â”œâ”€â”€ Dockerfile                         # Flask app image definition
â”œâ”€â”€ docker-compose.yml                 # Optional local test
â”œâ”€â”€ flask-deployment.yaml              # Minikube: Flask Deployment & Service
â”œâ”€â”€ mongo-deployment.yaml              # Minikube: MongoDB Deployment & Service
â”œâ”€â”€ flask-deployment_eks.yaml          # EKS: Flask Deployment & Service
â”œâ”€â”€ mongo-deployment_eks.yaml          # EKS: MongoDB Deployment & Service
â”œâ”€â”€ screenshots/                       # All screenshots go here
â””â”€â”€ README.md
```

---

## ğŸ§± 1. Docker Image for Flask Application

### Dockerfile

define flask-todo image

---

## ğŸ§© 2. Local Test via Docker Compose and push to Docker Hub

### docker-compose.yml

```bash
docker-compose up
```

```bash
docker start flask
```

```bash
docker logs -f flask-todo
```
Open the service in a browser

âœ… **Screenshot:** ![Local App Running](screenshot/local_app_running.png)
âœ… **Screenshot:** ![Docker push](screenshot/dockerhub.png)

---

## â˜¸ï¸ 3. Deploy on Minikube

### Start Cluster

```bash
minikube start
```

### Deploy MongoDB + Flask

```bash
kubectl apply -f mongo-deployment.yaml
kubectl apply -f flask-deployment.yaml
```

### Verify

```bash
kubectl get pods
kubectl get svc
```

### Access the App

```bash
minikube service flask-to-service
```

### Stop MiniKube service

```bash
minikube stop
```

âœ… **Screenshots:**

* ![Minikube Pods](screenshot/minikube_deploy.png)
* ![App Running](screenshot/minikube_app_running.png)

---

## â˜ï¸ 4. Deploy on AWS EKS

### Create Cluster (via AWS Console)

1. Navigate to EKS â†’ **Create Cluster**
2. Choose Kubernetes version 1.33
3. Add Node Group (t3.medium Ã— 2)
4. Wait until status = **Active**

âœ… **Screenshot:** ![EKS Console](screenshot/eks_cluster_console.png)

### Create new config

```bash
aws eks --region us-east-1 update-kubeconfig --name <cluster_name>
kubectl get nodes
```
âœ… **Screenshot:** ![EKS Console](screenshot/eks_get_node.png)

### Switch kubectl to EKS cluster config

```bash
kubectl config get-contexts 
kubectl config use-context arn:aws:eks:us-east-1:767828756359:cluster/nyu-flask-eks
```

### Deploy App

```bash
kubectl apply -f mongo-deployment_eks.yaml
kubectl apply -f flask-deployment_eks.yaml
```

### Check Status

```bash
kubectl get pods
kubectl get svc
```

### Open service
```bash
http://aac29ca36dc684ab3b215927d1e76622-1360838796.us-east-1.elb.amazonaws.com:5000
```

âœ… **Screenshots:**

* ![EKS Service](screenshot/eks_pod_service.png)
* ![EKS App Running](screenshot/eks_app_running.png)

---

## ğŸ”„ 5. Deployments and ReplicaSets

```bash
# Check deployment
kubectl get deployment flask-todo-deployment
```

```bash
# Check ReplicaSets
kubectl get rs
```

âœ… **Screenshot:** ![rs](screenshot/eks_rs.png)

### Pod Recovery Demo

```bash
kubectl delete pod <flask_pod_name>
kubectl get pods
```

âœ… **Screenshot:** ![Pod Recovery](screenshot/pod_recovery.png)

---

## ğŸ”„ 6. Rolling Update

```bash
# Update image version
kubectl set image deployment/flask-deployment flask=yw8988/flask-todo:v2

# Check rollout progress
kubectl rollout status deployment/flask-deployment
```

âœ… **Screenshot:** ![Rolling Update](screenshot/rolling_update.png)

### Pod Recovery Demo

```bash
kubectl delete pod <flask_pod_name>
kubectl get pods
```

âœ… **Screenshot:** ![Pod Recovery](screenshot/pod_recovery.png)

---

## â¤ï¸â€ğŸ”¥ 6. Health Probes and Monitoring

```yaml
livenessProbe:
  httpGet:
    path: /
    port: 5000
  initialDelaySeconds: 10
  periodSeconds: 15

readinessProbe:
  httpGet:
    path: /
    port: 5000
  initialDelaySeconds: 5
  periodSeconds: 10
```

Check:

```bash
kubectl describe pod <flask_pod_name>
```

âœ… **Screenshot:** ![Health Probe](screenshots/health_probe_status.png)

---

## ğŸ“ˆ 7. ReplicaSet Scaling

```bash
kubectl scale deployment flask-deployment --replicas=3
kubectl get rs
```

âœ… **Screenshot:** ![ReplicaSet Scaled](screenshots/replicaset_scaled.png)

---

## âš¡ (Extra Credit 30 pts) Prometheus + Slack Alerting

Optional bonus section for alert integration tests.
Include: `prometheus-deployment.yaml`, `alertmanager-config.yaml`, and Slack alert screenshot.
